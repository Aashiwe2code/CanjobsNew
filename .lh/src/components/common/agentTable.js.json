{
    "sourceFile": "src/components/common/agentTable.js",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 0,
            "patches": [
                {
                    "date": 1714023175830,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                }
            ],
            "date": 1714023175830,
            "name": "Commit-0",
            "content": "import React, { useEffect, useState } from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\nimport SAlert from \"../common/sweetAlert\";\r\nimport { toast } from \"react-toastify\";\r\nimport \"react-toastify/dist/ReactToastify.css\";\r\nimport Pagination from \"../common/pagination\";\r\nimport Loader from \"../common/loader\";\r\nimport { LiaUserEditSolid } from \"react-icons/lia\";\r\nimport { RiDeleteBin5Line } from \"react-icons/ri\";\r\nimport { GetAgent, DeleteAgent } from \"../../api/api\";\r\nimport { MdFormatListBulletedAdd } from \"react-icons/md\";\r\nimport AgentsEmployee from \"./AgentEmployee\";\r\nexport default function AgentTable(props) {\r\n  /*Show modal states */\r\n  let [apiCall, setApiCall] = useState(false);\r\n  let [isLoading, setIsLoading] = useState(true);\r\n  const [AgentId, setAgentId] = useState(\r\n    props.user === \"agent\" ? localStorage.getItem(\"agent_id\") : \"\"\r\n  );\r\n  //   let [showAddEmployeeModal, setShowEmployeeMOdal] = useState(false);\r\n  //   let [showVisaModal, setVisaModal] = useState(false);\r\n  //   let [showChangeJobModal, setShowChangeJobModal] = useState(false);\r\n  //   let [showEducationModal, setShowEducationModal] = useState(false);\r\n  //   let [showSkillsModal, setShowSkillsModal] = useState(false);\r\n  //   // let [documentModal, setDocumentModal] = useState(false);\r\n  //   let [showStatusChangeModal, setShowStatusChange] = useState(false);\r\n  /*data and id states */\r\n  const [agenteData, setAgentData] = useState([]);\r\n  //   const [alredyApplied, setAlredyApplied] = useState(false);\r\n  //   let [employeeId, setemployeeId] = useState();\r\n  /*delete state */\r\n  const [deleteAlert, setDeleteAlert] = useState(false);\r\n  const [deleteId, setDeleteID] = useState();\r\n  const [deleteName, setDeleteName] = useState(\"\");\r\n  /*Pagination states */\r\n  const [totalData, setTotalData] = useState(\"\");\r\n  const [recordsPerPage] = useState(10);\r\n  /*Shorting states */\r\n  const [columnName, setcolumnName] = useState(\"id\");\r\n  const [sortOrder, setSortOrder] = useState(\"\");\r\n  /* Function to get Employee data*/\r\n  const AgentData = async () => {\r\n    // const params = useParams();\r\n    setIsLoading(true);\r\n    try {\r\n      const userData = await GetAgent(\r\n        props.user === \"agent\" ? AgentId : \"\",\r\n        props.search,\r\n        props.pageNo,\r\n        recordsPerPage,\r\n        columnName,\r\n        sortOrder\r\n      );\r\n      if (userData.data.data === undefined || userData.data.data.length === 0) {\r\n        setAgentData([]);\r\n        setIsLoading(false);\r\n        setTotalData(0);\r\n      } else {\r\n        setAgentData(userData.data.data);\r\n        setTotalData(userData.data.total_rows);\r\n        // setAgentId(userData.data.data[0].id);\r\n        //Condition to get the Employee of Agent id\r\n        const filteredItems = userData.data.data.filter(\r\n          (item) => item.agent_employee_count > 0\r\n        );\r\n        if (filteredItems.length === 0) {\r\n          setAgentId();\r\n        } else {\r\n          // setAgentId 4: Get the First Item\r\n          setAgentId(filteredItems[0].id);\r\n        }\r\n        setIsLoading(false);\r\n        // if (\r\n        //   props.heading === \"Dashboard\" ||\r\n        //   location.pathname === \"/employee\" ||\r\n        //   props.lima === \"no\" ||\r\n        //   props.user === \"user\"\r\n        // ) {\r\n        //   setresponseId();\r\n        // } else {\r\n        //   //condition to get the response from job id\r\n        //   const filteredItems = userData.data.filter(\r\n        //     (item) =>\r\n        //       (props.selfJob === \"yes\"\r\n        //         ? item.applied_by_self\r\n        //         : item.applied_by_admin) > 0\r\n        //   );\r\n        //   if (filteredItems.length === 0) {\r\n        //     setresponseId();\r\n        //   } else {\r\n        //     // Step 4: Get the First Item\r\n        //     setresponseId(filteredItems[0].job_id);\r\n        //   }\r\n        // }\r\n      }\r\n    } catch (err) {\r\n      console.log(err);\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  /*Render function to get the employer*/\r\n  useEffect(() => {\r\n    AgentData();\r\n    if (props.apiCall === true || apiCall === true) {\r\n      props.setApiCall(false);\r\n      setApiCall(false);\r\n      if (props.user === \"agent\") {\r\n        setAgentId(localStorage.getItem(\"agent_id\"));\r\n      } else {\r\n        setAgentId(\"\");\r\n      }\r\n    }\r\n    // if (alredyApplied === true) {\r\n    //   setAlredyApplied(false);\r\n    // }\r\n    // eslint-disable-next-line\r\n  }, [\r\n    props.search,\r\n    props.pageNo,\r\n    recordsPerPage,\r\n    columnName,\r\n    sortOrder,\r\n    props.apiCall,\r\n    apiCall,\r\n  ]);\r\n\r\n  /* Function to show the single data to update Employee*/\r\n  // const employeeDetails = (e) => {\r\n  //   props.employeeDetails(e);\r\n  // };\r\n\r\n  /*To Show the delete alert box */\r\n  const ShowDeleteAlert = (e) => {\r\n    setDeleteID(e.id);\r\n    setDeleteName(e.name);\r\n    setDeleteAlert(true);\r\n  };\r\n\r\n  //   /*To cancel the delete alert box */\r\n  const CancelDelete = () => {\r\n    setDeleteAlert(false);\r\n  };\r\n\r\n  /*Function to open add Document up modal */\r\n  // const AddDoucument = (e) => {\r\n  //   setDocumentModal(true);\r\n  //   setemployeeId(e);\r\n  // };\r\n  // /*\r\n  /*To call Api to delete employee */\r\n  async function OnDeleteAgent(e) {\r\n    try {\r\n      const responseData = await DeleteAgent(e);\r\n      if (responseData.message === \"successfully\") {\r\n        toast.error(\"Partner deleted Successfully\", {\r\n          position: toast.POSITION.TOP_RIGHT,\r\n          autoClose: 1000,\r\n        });\r\n        setDeleteAlert(false);\r\n        setApiCall(true);\r\n        props.setApiCall(true);\r\n      }\r\n    } catch (err) {\r\n      console.log(err);\r\n    }\r\n  }\r\n\r\n  /*Pagination Calculation */\r\n  const nPages = Math.ceil(totalData / recordsPerPage);\r\n\r\n  /*Sorting Function */\r\n  const handleSort = (columnName) => {\r\n    setSortOrder(sortOrder === \"DESC\" ? \"ASC\" : \"DESC\");\r\n    setcolumnName(columnName);\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <div className=\"bg-white shadow-8 datatable_div  pt-7 rounded pb-8 px-2 \">\r\n        <div className=\"table-responsive main_table_div\">\r\n          {isLoading ? (\r\n            <Loader />\r\n          ) : (\r\n            <table className=\"table table-striped main_data_table\">\r\n              <thead>\r\n                <tr className=\"\">\r\n                  <th\r\n                    scope=\"col\"\r\n                    className=\" border-0 font-size-4 font-weight-normal\"\r\n                  >\r\n                    <Link\r\n                      to={\"\"}\r\n                      onClick={() => {\r\n                        handleSort(\"u_id\");\r\n                        props.setpageNo(1);\r\n                      }}\r\n                      className=\"text-gray\"\r\n                      title=\"Sort by Name\"\r\n                    >\r\n                      DN\r\n                    </Link>\r\n                  </th>\r\n                  <th\r\n                    scope=\"col\"\r\n                    className=\" border-0 font-size-4 font-weight-normal\"\r\n                  >\r\n                    <Link\r\n                      to={\"\"}\r\n                      onClick={() => {\r\n                        handleSort(\"name\");\r\n                        props.setpageNo(1);\r\n                      }}\r\n                      className=\"text-gray\"\r\n                      title=\"Sort by Name\"\r\n                    >\r\n                      Name\r\n                    </Link>\r\n                  </th>\r\n                  <th\r\n                    scope=\"col\"\r\n                    className=\"border-0 font-size-4 font-weight-normal\"\r\n                  >\r\n                    <Link\r\n                      to={\"\"}\r\n                      onClick={() => {\r\n                        handleSort(\"contact_no\");\r\n                        props.setpageNo(1);\r\n                      }}\r\n                      className=\"text-gray\"\r\n                      title=\"Sort by Contact\"\r\n                    >\r\n                      Contact\r\n                    </Link>\r\n                  </th>\r\n                  {/* {props.heading === \"Dashboard\" ? (\r\n                    \"\"\r\n                  ) : (\r\n                    <th\r\n                      scope=\"col\"\r\n                      className=\"border-0 font-size-4 font-weight-normal\"\r\n                    >\r\n                      <Link\r\n                        to={\"\"}\r\n                        onClick={() => {\r\n                          handleSort(\"type\");\r\n                          props.setpageNo(1);\r\n                        }}\r\n                        className=\"text-gray\"\r\n                        title=\"Sort by Type\"\r\n                      >\r\n                        Type\r\n                      </Link>\r\n                    </th>\r\n                  )} */}\r\n                  {props.heading === \"Dashboard\" ? (\r\n                    \"\"\r\n                  ) : (\r\n                    <th\r\n                      scope=\"col\"\r\n                      className=\"border-0 font-size-4 font-weight-normal\"\r\n                    >\r\n                      <Link\r\n                        to={\"\"}\r\n                        onClick={() => {\r\n                          handleSort(\"address\");\r\n                          props.setpageNo(1);\r\n                        }}\r\n                        className=\"text-gray\"\r\n                        title=\"Sort by Address\"\r\n                      >\r\n                        Address\r\n                      </Link>\r\n                    </th>\r\n                  )}\r\n                  {props.heading === \"Dashboard\" ? (\r\n                    \"\"\r\n                  ) : (\r\n                    <th\r\n                      scope=\"col\"\r\n                      className=\"border-0 font-size-4 font-weight-normal\"\r\n                    >\r\n                      <Link\r\n                        to={\"\"}\r\n                        onClick={() => {\r\n                          handleSort(\"country\");\r\n                          props.setpageNo(1);\r\n                        }}\r\n                        className=\"text-gray\"\r\n                        title=\"Sort by Country\"\r\n                      >\r\n                        Country\r\n                      </Link>\r\n                    </th>\r\n                  )}\r\n                  {props.heading === \"Dashboard\" ? (\r\n                    \"\"\r\n                  ) : (\r\n                    <th\r\n                      scope=\"col\"\r\n                      className=\"border-0 font-size-4 font-weight-normal\"\r\n                    >\r\n                      Action\r\n                    </th>\r\n                  )}\r\n                </tr>\r\n              </thead>\r\n              <tbody>\r\n                {/* Map function to show the data in the list*/}\r\n                {totalData === 0 || agenteData.length === 0 ? (\r\n                  <tr>\r\n                    <th colSpan={6} className=\"bg-white text-center\">\r\n                      No Data Found\r\n                    </th>\r\n                  </tr>\r\n                ) : (\r\n                  (agenteData || []).map((data) => (\r\n                    <React.Fragment key={data.id}>\r\n                      <tr className=\"text-capitalize applicant_row\">\r\n                        <td className=\" py-5\">\r\n                          <p className=\"font-size-3 font-weight-normal text-black-2 mb-0\">\r\n                            {data.u_id}\r\n                          </p>\r\n                        </td>\r\n                        <td className=\" py-5\">\r\n                          {/* <Link\r\n                        //   to={`/${data.employee_id}`}\r\n                          // onClick={\r\n                          //   data.name !== null\r\n                          //     ? () => employeeDetails(data.employee_id)\r\n                          //     : null\r\n                          // }\r\n                          title=\"Candidate Details\"\r\n                        > */}\r\n                          <div className=\"d-flex profile_box gx-2\">\r\n                            <div className=\"media  align-items-center\">\r\n                              <div className=\"circle-30 mx-auto overflow-hidden\">\r\n                                {data.profile_image === null ? (\r\n                                  <img\r\n                                    src=\"https://cdn.pixabay.com/photo/2015/10/05/22/37/blank-profile-picture-973460__340.png\"\r\n                                    alt=\"\"\r\n                                    className=\"w-100\"\r\n                                  />\r\n                                ) : (\r\n                                  <img\r\n                                    src={data.profile_image}\r\n                                    alt=\"\"\r\n                                    className=\"w-100\"\r\n                                  />\r\n                                )}\r\n                              </div>\r\n                            </div>\r\n\r\n                            <div className=\" mb-0\">\r\n                              {data.name === null ||\r\n                              data.name === undefined ||\r\n                              data.name === \"undefined\" ||\r\n                              data.name === \"\" ? (\r\n                                <p className=\"font-size-3  mb-0\">N/A</p>\r\n                              ) : (\r\n                                <p\r\n                                  className=\"m-0 text-black-2 font-weight-bold text-capitalize text-truncate\"\r\n                                  title={data.name}\r\n                                >\r\n                                  {data.name}\r\n                                </p>\r\n                              )}\r\n                              {/* {data.gender || data.marital_status ? (\r\n                                <p className=\"text-gray font-size-2 m-0 text-capitalize\">\r\n                                  {data.gender === \"female\"\r\n                                    ? \"F\"\r\n                                    : data.gender === \"male\"\r\n                                    ? \"M\"\r\n                                    : \"O\"}\r\n                                  //Calculation of age from date of birth\r\n                                  (\r\n                                  {data.marital_status ||\r\n                                  data.date_of_birth\r\n                                    ? `${\r\n                                        data.marital_status\r\n                                      },${moment().diff(\r\n                                        data.date_of_birth,\r\n                                        \"years\"\r\n                                      )} Y`\r\n                                    : null}\r\n                                  )\r\n                                </p>\r\n                              ) : null} */}\r\n                            </div>\r\n                          </div>\r\n                          {/* </Link> */}\r\n                        </td>\r\n                        <td className=\"py-5 \">\r\n                          {(data.contact_no === null ||\r\n                            data.contact_no === undefined ||\r\n                            data.contact_no === \"undefined\" ||\r\n                            data.contact_no === \"\" ||\r\n                            data.contact_no === \"0\") &&\r\n                          (data.email === null ||\r\n                            data.email === undefined ||\r\n                            data.email === \"undefined\" ||\r\n                            data.email === \"\") ? (\r\n                            <p className=\"font-size-3  mb-0\">N/A</p>\r\n                          ) : (\r\n                            <p className=\"m-0\">\r\n                              <Link\r\n                                className=\"text-dark\"\r\n                                to={`tel:${data.contact_no}`}\r\n                              >\r\n                                {data.contact_no === \"0\"\r\n                                  ? \"\"\r\n                                  : `+${data.contact_no}`}\r\n                              </Link>\r\n                              <p className=\"text-gray font-size-2 m-0\">\r\n                                <Link\r\n                                  className=\"text-dark\"\r\n                                  to={`mailto:${data.email}`}\r\n                                >\r\n                                  {data.email}\r\n                                </Link>\r\n                              </p>\r\n                            </p>\r\n                          )}\r\n                        </td>\r\n\r\n                        {/* {props.heading === \"Dashboard\" ? (\r\n                        \"\"\r\n                      ) : (\r\n                        <td className=\" py-5\">\r\n                          {data.type === null ? (\r\n                            <p className=\"font-size-3  mb-0\">N/A</p>\r\n                          ) : (\r\n                            <h3 className=\"font-size-3 font-weight-normal text-black-2 mb-0\">\r\n                              <p className=\"text-gray font-size-2 m-0\">\r\n                                {data.type}\r\n                              </p>\r\n                            </h3>\r\n                          )}\r\n                        </td>\r\n                      )} */}\r\n                        {props.heading === \"Dashboard\" ? (\r\n                          \"\"\r\n                        ) : (\r\n                          <td className=\" py-5\">\r\n                            {data.address === null ||\r\n                            data.address === undefined ||\r\n                            data.address === \"undefined\" ||\r\n                            data.address === \"\" ? (\r\n                              <p className=\"font-size-3  mb-0\">N/A</p>\r\n                            ) : (\r\n                              <p\r\n                                className=\"font-size-3 font-weight-normal text-black-2 mb-0 text-truncate\"\r\n                                title={data.address}\r\n                              >\r\n                                {data.address}\r\n                              </p>\r\n                            )}\r\n                          </td>\r\n                        )}\r\n                        {props.heading === \"Dashboard\" ? (\r\n                          \"\"\r\n                        ) : (\r\n                          <td className=\" py-5\">\r\n                            {(data.city === null ||\r\n                              data.city === undefined ||\r\n                              data.city === \"undefined\" ||\r\n                              data.city === \"\") &&\r\n                            (data.state === null ||\r\n                              data.state === undefined ||\r\n                              data.state === \"undefined\" ||\r\n                              data.state === \"\") &&\r\n                            (data.country === null ||\r\n                              data.country === undefined ||\r\n                              data.country === \"undefined\" ||\r\n                              data.country === \"\") ? (\r\n                              <p className=\"font-size-3  mb-0\">N/A</p>\r\n                            ) : (\r\n                              <p\r\n                                className=\"font-size-3 font-weight-normal text-black-2 mb-0 text-truncate\"\r\n                                title={` ${data.city},${data.state},${data.country}`}\r\n                              >\r\n                                {` ${data.city},${data.state},${data.country}`}\r\n                              </p>\r\n                            )}\r\n                          </td>\r\n                        )}\r\n                        <td className=\" py-5 min-width-px-100\">\r\n                          <div\r\n                            className=\"btn-group button_group\"\r\n                            role=\"group\"\r\n                            aria-label=\"Basic example\"\r\n                          >\r\n                            <button\r\n                              className=\"btn btn-outline-info action_btn\"\r\n                              onClick={() => {\r\n                                setAgentId(data.id);\r\n                              }}\r\n                              title=\"Candidate's\"\r\n                              disabled={data.agent_employee_count === \"0\" || 0}\r\n                            >\r\n                              <span className=\"text-gray px-2\">\r\n                                <MdFormatListBulletedAdd />\r\n                              </span>\r\n                              {/* <i className=\"fa fa-list\"></i> */}\r\n                            </button>\r\n                            <button\r\n                              className=\"btn btn-outline-info action_btn\"\r\n                              onClick={() => props.EditAgent(data)}\r\n                              title=\"Edit Partner\"\r\n                            >\r\n                              <span className=\"text-gray px-2\">\r\n                                <LiaUserEditSolid />\r\n                              </span>\r\n                            </button>\r\n                            <button\r\n                              className={\r\n                                props.user === \"agent\"\r\n                                  ? \"d-none\"\r\n                                  : \"btn btn-outline-info action_btn\"\r\n                              }\r\n                              onClick={() => ShowDeleteAlert(data)}\r\n                              title=\"Delete Partner\"\r\n                            >\r\n                              <span className=\"px-2 text-danger\">\r\n                                <RiDeleteBin5Line />\r\n                              </span>\r\n                            </button>\r\n                          </div>\r\n                        </td>\r\n                      </tr>\r\n                      {data.id === AgentId &&\r\n                      data.agent_employee_count !== (0 || \"0\") ? (\r\n                        <tr>\r\n                          <td colSpan={11}>\r\n                            {\r\n                              <>\r\n                                {/* <!-- Agent by emmployee --> */}\r\n                                <AgentsEmployee\r\n                                  Agentid={AgentId}\r\n                                  apiCall={apiCall}\r\n                                  setApiCall={setApiCall}\r\n                                  heading={\"Manage Partner\"}\r\n                                />\r\n                              </>\r\n                            }\r\n                          </td>\r\n                        </tr>\r\n                      ) : null}\r\n                    </React.Fragment>\r\n                  ))\r\n                )}\r\n              </tbody>\r\n            </table>\r\n          )}\r\n        </div>\r\n        <div className=\"pt-2\">\r\n          <Pagination\r\n            nPages={nPages}\r\n            currentPage={props.pageNo}\r\n            setCurrentPage={props.setpageNo}\r\n            total={totalData}\r\n            count={agenteData.length}\r\n          />\r\n        </div>\r\n      </div>\r\n      <SAlert\r\n        show={deleteAlert}\r\n        title={deleteName}\r\n        text=\"Are you Sure you want to delete !\"\r\n        onConfirm={() => OnDeleteAgent(deleteId)}\r\n        showCancelButton={true}\r\n        onCancel={CancelDelete}\r\n      />\r\n    </>\r\n  );\r\n}\r\n"
        }
    ]
}